<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <title>Ø­Ø§Ù„Øª ØªÙˆØ³Ø¹Ù‡ - Ø´Ù„Ù…</title>
  <link rel="stylesheet" href="css/style.css">
  <style>
    #devPanel {
      position: fixed;
      top: 10px;
      left: 10px;
      background: rgba(0,0,0,0.9);
      border: 2px solid #ffd700;
      border-radius: 10px;
      padding: 15px;
      z-index: 9999;
      max-width: 300px;
      font-size: 12px;
    }
    #devPanel h3 {
      color: #ffd700;
      margin: 0 0 10px 0;
      font-size: 14px;
    }
    #devPanel .section {
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid #333;
    }
    #devPanel .section-title {
      color: #888;
      font-size: 11px;
      margin-bottom: 5px;
    }
    #devPanel button {
      background: #2a4a7a;
      color: white;
      border: none;
      padding: 6px 10px;
      margin: 2px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 11px;
    }
    #devPanel button:hover {
      background: #3a6aaa;
    }
    #devPanel button.primary {
      background: #4a8a4a;
    }
    #devPanel button.danger {
      background: #8a4a4a;
    }
    #devPanel select {
      background: #1a2a4a;
      color: white;
      border: 1px solid #444;
      padding: 5px;
      border-radius: 5px;
      width: 100%;
      margin-bottom: 5px;
    }
    #devPanel .info {
      color: #aaa;
      font-size: 10px;
      margin-top: 5px;
    }
    #togglePanel {
      position: fixed;
      top: 10px;
      left: 10px;
      background: #ffd700;
      color: black;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
      z-index: 10000;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <button id="togglePanel" onclick="toggleDevPanel()">ğŸ”§ Dev</button>
  
  <div id="devPanel">
    <h3>ğŸ”§ Ù¾Ù†Ù„ ØªÙˆØ³Ø¹Ù‡â€ŒØ¯Ù‡Ù†Ø¯Ù‡</h3>
    
    <div class="section">
      <div class="section-title">Ø´Ø±ÙˆØ¹ Ø³Ø±ÛŒØ¹</div>
      <button class="primary" onclick="devQuickStart('playing')">â–¶ï¸ Ø¨Ø§Ø²ÛŒ</button>
      <button onclick="devQuickStart('proposing')">ğŸ“¢ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯</button>
      <button onclick="devQuickStart('exchanging')">ğŸ”„ ØªØ¹ÙˆÛŒØ¶</button>
      <button onclick="devQuickStart('modeSelection')">ğŸ¯ Ø§Ù†ØªØ®Ø§Ø¨ Ù†ÙˆØ¹</button>
    </div>

    <div class="section">
      <div class="section-title">ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø´Ø±ÙˆØ¹</div>
      <select id="devGameMode">
        <option value="hokm">Ø­Ú©Ù…</option>
        <option value="nars">Ù†ÙØ±Ø³</option>
        <option value="asNars">Ø¢Ø³â€ŒÙ†ÙØ±Ø³</option>
        <option value="sars">Ø³ÙØ±Ø³</option>
      </select>
      <select id="devMasterSuit">
        <option value="â™ ">â™  Ù¾ÛŒÚ©</option>
        <option value="â™¥">â™¥ Ø¯Ù„</option>
        <option value="â™¦">â™¦ Ø®Ø´Øª</option>
        <option value="â™£">â™£ Ú¯Ø´Ù†ÛŒØ²</option>
      </select>
    </div>

    <div class="section">
      <div class="section-title">Ú©Ù†ØªØ±Ù„ Ø¨Ø§Øªâ€ŒÙ‡Ø§</div>
      <button onclick="devBotPlay()">ğŸ¤– Ø¨Ø§Ø²ÛŒ ÛŒÚ© Ø¨Ø§Øª</button>
      <button class="primary" onclick="devBotPlayAll()">ğŸ¤–ğŸ¤–ğŸ¤– Ø¨Ø§Ø²ÛŒ Ù‡Ù…Ù‡ Ø¨Ø§Øªâ€ŒÙ‡Ø§</button>
    </div>

    <div class="section">
      <div class="section-title">Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ</div>
      <button onclick="devSimulateProposal()">ğŸ“¢ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§Øª</button>
      <button onclick="devSimulateExchange()">ğŸ”„ ØªØ¹ÙˆÛŒØ¶</button>
    </div>

    <div class="section">
      <div class="section-title">Ø¹Ù…Ù„ÛŒØ§Øª</div>
      <button onclick="devRefresh()">ğŸ”„ Ø±ÙØ±Ø´ ÙˆØ¶Ø¹ÛŒØª</button>
      <button class="danger" onclick="location.reload()">ğŸ” Ø±ÛŒØ³ØªØ§Ø±Øª Ú©Ø§Ù…Ù„</button>
    </div>

    <div class="info">
      ğŸ’¡ Ú©Ù„ÛŒØ¯Ù‡Ø§ÛŒ Ù…ÛŒØ§Ù†Ø¨Ø±:<br>
      B = Ø¨Ø§Ø²ÛŒ Ø¨Ø§Øª | R = Ø±ÙØ±Ø´ | P = Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ
    </div>
  </div>

  <div id="lobby" style="display:none"></div>
  
  <div id="game" style="display:none">
    <div id="proposalOverlay" class="proposal-overlay" style="display:none">
      <div id="waitingMessage" class="waiting-message"></div>
    </div>
    <div id="topBar">
      <div class="score-item team1">
        <span class="team-label">ØªÛŒÙ… Û±</span>
        <span class="score-value" id="score0">0</span>
      </div>
      <div class="game-info">
        <div id="contractDisplay"></div>
        <div id="trumpDisplay"></div>
      </div>
      <div class="score-item team2">
        <span class="team-label">ØªÛŒÙ… Û²</span>
        <span class="score-value" id="score1">0</span>
      </div>
    </div>
    <div id="voiceControls" style="display:none"></div>
    <div id="playerTop" class="opponent top">
      <div class="opponent-info">
        <span class="opponent-name"></span>
        <span class="card-count"></span>
      </div>
      <div class="opponent-cards"></div>
    </div>
    <div id="playerLeft" class="opponent left">
      <div class="opponent-info">
        <span class="opponent-name"></span>
        <span class="card-count"></span>
      </div>
      <div class="opponent-cards"></div>
    </div>
    <div id="playerRight" class="opponent right">
      <div class="opponent-info">
        <span class="opponent-name"></span>
        <span class="card-count"></span>
      </div>
      <div class="opponent-cards"></div>
    </div>
    <div id="tableCenter">
      <div id="dropZone">
        <div id="playedCards"></div>
        <div id="dropHint" style="display:none">ğŸ´ Ú©Ø§Ø±Øª Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø±Ù‡Ø§ Ú©Ù†ÛŒØ¯</div>
      </div>
      <div id="statusMessage"></div>
    </div>
    <div id="gameLog"></div>
    <div id="myHandArea">
      <div id="myInfo">
        <span id="myName"></span>
        <span id="turnIndicator"></span>
      </div>
      <div id="myHand"></div>
    </div>
    <div id="controls"></div>
    <div id="proposalPanel" class="proposal-panel" style="display:none">
      <div class="proposal-header">
        <h3>ğŸ“¢ Ø§Ù†ØªØ®Ø§Ø¨ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯</h3>
        <div id="proposalLogMini" class="proposal-log-mini"></div>
      </div>
      <div id="proposalGrid" class="proposal-grid"></div>
      <button class="btn-pass-big" onclick="passProposal()">âŒ Ù¾Ø§Ø³</button>
    </div>
  </div>

  <div id="modeModal" class="modal" style="display:none">
    <div class="modal-content mode-modal">
      <h3>ğŸ¯ Ø§Ù†ØªØ®Ø§Ø¨ Ù†ÙˆØ¹ Ø¨Ø§Ø²ÛŒ</h3>
      <div class="mode-options">
        <label class="mode-option">
          <input type="radio" name="gameMode" value="hokm">
          <div class="mode-card">
            <div class="mode-title">ğŸ‘‘ Ø­Ú©Ù…</div>
            <div class="mode-desc">Ø¢Ø³ Ù‚ÙˆÛŒâ€ŒØªØ±ÛŒÙ†</div>
          </div>
        </label>
        <label class="mode-option">
          <input type="radio" name="gameMode" value="nars">
          <div class="mode-card">
            <div class="mode-title">â¬‡ï¸ Ù†ÙØ±Ø³</div>
            <div class="mode-desc">Ø¯ÙˆÙ„Ùˆ Ù‚ÙˆÛŒâ€ŒØªØ±ÛŒÙ†</div>
          </div>
        </label>
        <label class="mode-option">
          <input type="radio" name="gameMode" value="asNars">
          <div class="mode-card">
            <div class="mode-title">ğŸ…°ï¸ Ø¢Ø³â€ŒÙ†ÙØ±Ø³</div>
            <div class="mode-desc">Ø¢Ø³ Ù‚ÙˆÛŒØŒ Ø´Ø§Ù‡ Ø¶Ø¹ÛŒÙ</div>
          </div>
        </label>
        <label class="mode-option">
          <input type="radio" name="gameMode" value="sars">
          <div class="mode-card">
            <div class="mode-title">ğŸš« Ø³ÙØ±Ø³</div>
            <div class="mode-desc">Ø¨Ø¯ÙˆÙ† Ø­Ú©Ù…</div>
          </div>
        </label>
      </div>
      <div id="suitSelector" class="suit-selector" style="display:none">
        <p>Ø®Ø§Ù„ Ø­Ú©Ù…:</p>
        <div class="suits">
          <button class="suit-btn" data-suit="â™ " onclick="selectSuit('â™ ')">â™ </button>
          <button class="suit-btn red" data-suit="â™¥" onclick="selectSuit('â™¥')">â™¥</button>
          <button class="suit-btn red" data-suit="â™¦" onclick="selectSuit('â™¦')">â™¦</button>
          <button class="suit-btn" data-suit="â™£" onclick="selectSuit('â™£')">â™£</button>
        </div>
      </div>
      <button id="confirmModeBtn" onclick="confirmMode()" disabled>Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</button>
    </div>
  </div>

  <div id="resultModal" class="modal" style="display:none">
    <div class="modal-content result-modal">
      <h3 id="resultTitle"></h3>
      <div id="resultCards"></div>
      <div id="resultPoints"></div>
    </div>
  </div>

  <div id="endModal" class="modal" style="display:none">
    <div class="modal-content end-modal">
      <h2 id="endTitle"></h2>
      <div id="endDetails"></div>
      <button onclick="playAgain()">ğŸ”„ Ø¨Ø§Ø²ÛŒ Ù…Ø¬Ø¯Ø¯</button>
    </div>
  </div>

  <div id="audioContainer" style="display:none"></div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="js/app.js"></script>
  <script>
    // Dev Mode Functions
    let devPanelVisible = true;

    function toggleDevPanel() {
      devPanelVisible = !devPanelVisible;
      document.getElementById('devPanel').style.display = devPanelVisible ? 'block' : 'none';
    }

    function devQuickStart(phase) {
      const options = {
        phase: phase,
        gameMode: document.getElementById('devGameMode').value,
        masterSuit: document.getElementById('devMasterSuit').value,
        contract: 100
      };
      socket.emit('devQuickStart', options);
    }

    function devBotPlay() {
      socket.emit('devBotPlay');
    }

    function devBotPlayAll() {
      socket.emit('devBotPlayAll');
    }

    function devSimulateProposal() {
      socket.emit('devSimulateProposal');
    }

    function devSimulateExchange() {
      socket.emit('devSimulateExchange');
    }

    function devRefresh() {
      socket.emit('devRefresh');
    }

    // Auto-join on load
    window.addEventListener('load', () => {
      socket.emit('devJoin');
      document.getElementById('game').style.display = 'flex';
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (e.target.tagName === 'INPUT') return;
      
      switch(e.key.toLowerCase()) {
        case 'b':
          devBotPlayAll();
          break;
        case 'r':
          devRefresh();
          break;
        case 'p':
          devQuickStart('playing');
          break;
        case 'd':
          toggleDevPanel();
          break;
      }
    });
  </script>
</body>
</html>